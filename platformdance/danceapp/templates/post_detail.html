{% extends 'base.html' %}
{% block content %}
<h1>Post_detail Page</h1>
<h1>User 에 따른 Post 따로 보기</h1>
<!-- user이름 찾아뽑아야함 : {{ posts.query }} -->
{{ user.username }}
<hr>

<table border="1">
    <tr>
        <td>userId</td>
        <td>userId_id</td>
        <td>title</td>
        <td>body</td>
        <td>comment</td>
    </tr>
    {% for post in posts %}
    <tr>
        <td>{{ post.userId }}</td>
        <td>{{ post.userId_id }}</td>
        <td>{{ post.title }}</td>
        <td>{{ post.body }}</td>
        <td>
            <details>
                <summary>댓글</summary>
                {% for comment in post.comment_set.all %}
                <label for=""></label>
                {{ comment.userId }} - {{ comment }}
                {% if request.user == comment.userId %}
                <input type="submit" value="삭제">
                {% endif %}
                <br>
                {% endfor %}
                <form method="POST" action="{% url 'new_comment' post.id %}">
                    {% csrf_token %}
                    {{ comment_form.as_p }}
                    <input type="submit" value="댓글 입력">
                </form>
            </details>
        </td>
        <td>
            <form action="{% url 'likes' post.id %}" method="POST">
                {% csrf_token %}
                <p>
                    좋아요 수 : {{ post.likes_count }}
                </p>
                {% if request.user in post.likes_user.all %}
                <input type="submit" value="dislike">
                {% else %}
                <input type="submit" value="like">
                {% endif %}
            </form>
        </td>
    </tr>
    {% endfor %}
</table>
{% endblock %}