{% extends 'base.html' %}
{% block content %}
{% load static %}


<div id="detail-section">
    <section>
        <div>
            <div class="title-sy">{{ post.title }}</div>

            <!-- <video src="" controls></video> -->
            {% if post.video %}
            <video src="{{ post.video.url }}" controls></video>
            {% else %}
            <h3>영상이 없습니다</h3>
            {% endif %}

            <div class="videoinfo">
                <div class="info-sy">조회수 {{ post.hits }} | 좋아요 {{ post.likes_count }} | {{ post.uploadDate }}</div>
                <!-- <button id="good">좋아요</button> -->
                <!-- <button id="hate">싫어요</button> -->
                {% if request.user.is_authenticated %}
                <form action="{% url 'likes' post.id %}" method="">
                    {% csrf_token %}
                    
                    {% if request.user in post.likes_user.all %}
                     <button type="submit" id="hate" value="dislike">
                        <img src="{% static 'img/good.png' %}" alt="이미지없음">
                    </button>
                    {% else %}

                     <button type="submit" id="hate" value="like">
                        <img src="{% static 'img/goodb.png' %}" alt="이미지없음">
                    </button>
                    {% endif %}
                </form>
                {% endif %}
            </div>
            <!-- 사용자 정보 -->
            <div class="userinfo">
                <div class="box-sy1">
                    {% if post.userId.profilephoto %}
                    <img src="{{ post.userId.profilephoto.url }}" class="userimg-sy">
                    {% else %}
                    <h6>#none</h6>
                    {% endif %}
                </div>
                <div id="nf">
                    <div class="nf-name">{{ post.userId.username }}</div>
                    <div>팔로워 : 1.9만명</div>
                </div>
                <hr style="border: 1px solid rgba(255, 255, 255, 0.3); 
                width: 980px;height: 0px; margin-bottom: 71px;">
            </div>
        </div>

        <!-- 댓글기능 -->
        <div>
            <div class="com-box">
                <div class="box-sy2">
                    {% if post.userId.profilephoto %}
                    <img src="{{ request.user.profilephoto.url }}" class="userimg-sy">
                    {% else %}
                    <h6>#none</h6>
                    {% endif %}
                </div>
                    <div class="com-name">{{ request.user.username }}</div>
                    <div class="com-foll">
                        <!-- 댓글 달기 -->
                        {% if request.user.is_authenticated %}
                        <form method="POST" action="{% url 'new_comment' post.id %}">
                            {% csrf_token %}
                            <style>
                                #comm{
                                    background-color: black;
                                    border-color: black;
                                    color: #FFFFFF;
                                    display: inline;
                                }
                            </style>
                            {{ comment_form }}
                            <input type="submit" class="iip" value="댓글 입력" style="float: right;">
                            <style>
                                input{
                                    background-color: white;
                                    display: inline-block;
                                }
                            </style>
            
                        </form>
                        {% endif %}
                    </div>
            </div> 
            <hr style="border: 2px solid #FFFFFF;
                width: 980px;height: 0px; margin-top: 10px;">
        </div>
        <div class="com-count">
            <!-- 댓글 30개 -->
            {% for comment in post.comment_set.all %}
            {{ comment.userId }} - {{ comment }}
            {% if request.user == comment.userId %}
            <form action="{% url 'delete_comment' comment.id %}" method="POST">
                {% csrf_token %}
                <input type="submit" name="delete_comment" value="삭제">
            </form>
            {% endif %}
            {% endfor %}
        </div>
        <div class="com-puls">더 읽기+</div>
    </section>
</div>
<script>
    let isClick = false;
    var ch=document.getElementById("hate");
    ch.addEventListener('click',(e)=>{
        e.preventDefault();
        ch.childNodes[1].src="{% static 'img/goodb.png' %}"
        if(ch.value==="like"){
            ch.value="dislike";
        }
        else{
            ch.value="like";
        }
    });
</script>

{% endblock %}